<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/webaudio-controls/webaudio-controls.html">


<dom-module name="pedal-quadrafuzz">
    <style>
        :host{
            background-color: #f91a18;
            background: linear-gradient(tomato, crimson);
            box-shadow: inset -3px -3px 3px 5px rgba(0,0,0,0.6),inset 3px 3px 3px 5px rgba(255,255,255,0.5),0 2px 4px -1px rgba(0,0,0,0.9),0 4px 5px 0 rgba(0,0,0,0.9),0 1px 10px 0 rgba(0,0,0,0.9);

            width: 175px !important;
            height: 320px !important;
            border-radius: 10px;

            position: relative;
            display: block;
            user-select: none; 
        }
        .knob, .switch{
            position: absolute;
        }
        #knob1{
            top: 10px;
            left: 10px;
        }
        #knob2{
            top: 10px;
            left: 100px;
        }
        #knob3{
            top: 100px;
            left: 10px;
        }
        #knob4{
            top: 100px;
            left: 100px;
        }
        #switch1{
            top: 175px;
            left: 23px;
        }
        .pedalLabel{
            user-select: none; 
            position: absolute;
            right : 30px;
            top: 235px;
            font-size: 25px;
            font-family: Lemon\/Milk;
            text-align: center;
            line-height: 30px;
            width: 110px;
            color: white;
        }
        .knob-label{
            user-select: none; 
            position: absolute;
            font-size: 12px;
            line-height: 12px;
            width:64px;
            max-width:64px;
            overflow: hidden;
            text-align: center;
            font-family: Lemon\/Milk;
            color: white;
        }
        #knob1-label,
        #knob2-label{
            top: 74px;
        }
        #knob1-label{
            left: 10px;
        }
        #knob2-label{
            left: 100px;
        }
        #knob3-label,
        #knob4-label{
            top: 170px;
        }
        #knob3-label{
            left: 10px;
        }
        #knob4-label{
            left: 100px;
        }

    </style>
    <template>
        <webaudio-knob sprites="99" value="0" step="1" src="../img/knobs/nux_black_white_stripe.png" class="knob" id="knob1"></webaudio-knob>
        <p class="knob-label" id="knob1-label">LOWGAIN</p>
        <webaudio-knob sprites="99" value="0" step="1" src="../img/knobs/nux_black_white_stripe.png" class="knob" id="knob2"></webaudio-knob>
        <p class="knob-label" id="knob2-label">MIDLOW<br>GAIN</p>
        <webaudio-knob sprites="99" value="0" step="1" src="../img/knobs/nux_black_white_stripe.png" class="knob" id="knob3"></webaudio-knob>
        <p class="knob-label" id="knob3-label">MIDHIGH<br>GAIN</p>
        <webaudio-knob sprites="99" value="0" step="1" src="../img/knobs/nux_black_white_stripe.png" class="knob" id="knob4"></webaudio-knob>
        <p class="knob-label" id="knob4-label">HIGHGAIN</p>
        <webaudio-switch src="../img/switches/switch_1.png" class="switch" id="switch1" height="64" width="100"></webaudio-switch>
        <p class="pedalLabel">QUADRA FUZZ</p>
    </template>
    <script>
        PedalQuadrafuzz = Polymer({
            is: 'pedal-quadrafuzz',
            behaviors: [PedalBehavior],
            factoryImpl: function(options,isOn) {
              this.createAllInternNodes();
              this.connectInternNodes();
              this.resetKnobs();
              this.setRolesToKnobs();
              this.setKnobsListeners();
              this.setValuesToKnobs(options);
              this.setPedalActive(isOn);
              this.setSwitchListener();
            },
            createAllInternNodes: function () {
              //custom sound modification, here a Pizzicato delay
              this.effect = new Pizzicato.Effects.Quadrafuzz();
            },
            setKnobsListeners: function() {
              var knobs = this.getElementsByTagName("webaudio-knob");
              var t = this;
              knobs[0].addEventListener('change', function (e) { t.effect.lowGain = e.target.value/100;});
              knobs[1].addEventListener('change', function (e) { t.effect.midLowGain = e.target.value/100;});
              knobs[2].addEventListener('change', function (e) { t.effect.midHighGain = e.target.value/100;});
              knobs[3].addEventListener('change', function (e) { t.effect.highGain = e.target.value/100;});

            },
            setRolesToKnobs:function () {
              var knobs = this.getElementsByTagName("webaudio-knob");
              knobs[0].setAttribute("data-role","lowGain");
              knobs[1].setAttribute("data-role","midLowGain");
              knobs[2].setAttribute("data-role","midHighGain");
              knobs[3].setAttribute("data-role","highGain");
            },
            getDefaultButtonsValues: function() {
              return { lowGain : 60 , midLowGain : 80 , midHighGain: 50 ,highGain: 60};
            },
            bypass: function() {
              this.effect.bypass();
            },
            reactivate: function() {
              this.effect.reactivate();
            },
            connectInternNodes:function ()  {
              this.soundNodeIn.connect(this.effect);
              this.effect.connect(this.soundNodeOut);
            }
        });
    </script>
</dom-module>
